dependencies:
  - role: Comcast.sdkman
    vars:
      sdkman_user: "{{ java_sdkman_user }}"
      sdkman_group: "{{ java_sdkman_group }}"
      sdkman_update: true
      sdkman_auto_answer: true
      sdkman_tmp_dir: ~/.ansible/tmp
      sdkman_flush_caches_after:
        - temp
      sdkman_install_packages:
        - candidate: java
          version: "{{ java_version }}"

  - role: rustic_backup
    vars:
      backup_profiles:
        - identifier: "{{ user }}"
          directory: "{{ directory }}"
          globs: "{{ backup_file_globs }}"
          allow_sudo_backctl:
            from: "{{ user }}"
          # Generated with:
          # $ ansible-vault encrypt_string --vault-password-file secrets/vault_password --stdin-name 'mega_user'
          mega_user: !vault |
            $ANSIBLE_VAULT;1.1;AES256
            61623965646463343337616537393538333031643565336236643462356466323161643366656164
            6432626237633835383761333439636437363065343061610a383763643133386363643330666466
            63316536396463373339393139376132313935333065316239366665383630623236613361666263
            3264353763326639640a633836363430346235656634666537303461616538616234353831323236
            31643836353531396539356238663161633866393964316665663630386262376536
          mega_password: !vault |
            $ANSIBLE_VAULT;1.1;AES256
            66363330333466363534613939373166363839646437623937623031623763356639363634613932
            3930316230646166363531626132626335316133326236370a326165633565633632343562633937
            30373634666562326433356662653432303565616264613563343335303761336438343737363237
            3035393863373830310a623137356464663331323236633037383162376364643734626464336561
            39613532323430633666373161383330303534373830353234356564323239646431
          mega_folder_id: !vault |
            $ANSIBLE_VAULT;1.1;AES256
            62646562336262666133633433373236616261343165313635643461336539346638663630326161
            3861366330623337366565343962386362366462326331310a636333343133376663323864636232
            31616239663438306436326564636262366133333533373431646439653662626561653065306630
            3133636531333738320a303432616431623366636366613739376538366134636532303634653734
            3134
          mega_folder_name: !vault |
            $ANSIBLE_VAULT;1.1;AES256
            62396363643334353636326137396435383139383633303232323334303963343137616661623236
            3165306330323833333837646138376336323365373561360a613237613138383762663364646235
            33646238323963613961326263306333353064616533623336346361663137373634626461623334
            3932646633643036370a353938636533613466346362363438646265313066383535356637356263
            64316464313065623634626237646434383065393137623966316565353635323833

  - role: tmux_kiosk
    vars:
      users:
        - "{{ user }}"
